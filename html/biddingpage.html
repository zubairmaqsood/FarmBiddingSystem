<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Farm Auction Market</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7f0 0%, #e8ede0 100%);
            color: #2d3e1f;
            min-height: 100vh;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 20px;
            background: linear-gradient(135deg, #4a7c3e 0%, #5d9b4a 100%);
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(74, 124, 62, 0.3);
        }

        .header h1 {
            color: white;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            color: #e8f5e0;
            font-size: 1.1em;
        }

        .login-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            color: #4a7c3e;
            border: 2px solid #4a7c3e;
            padding: 10px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1em;
            transition: all 0.3s;
            z-index: 100;
        }

        .login-btn:hover {
            background: #4a7c3e;
            color: white;
        }

        .user-balance {
            position: fixed;
            top: 70px;
            right: 20px;
            background: white;
            color: #4a7c3e;
            border: 2px solid #4a7c3e;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            z-index: 100;
            display: none;
        }

        .search-container {
            max-width: 600px;
            margin: 0 auto 30px;
        }

        .search-bar {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #4a7c3e;
            border-radius: 30px;
            font-size: 1.1em;
            outline: none;
            transition: all 0.3s;
        }

        .search-bar:focus {
            border-color: #5d9b4a;
            box-shadow: 0 0 15px rgba(74, 124, 62, 0.2);
        }

        .auction-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .auction-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid #e0e8d8;
            position: relative;
            overflow: hidden;
        }

        .auction-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(74, 124, 62, 0.2);
            border-color: #5d9b4a;
        }

        .card-minimal {
            display: block;
        }

        .card-detailed {
            display: none;
            animation: fadeIn 0.3s;
        }

        .auction-card:hover .card-minimal {
            display: none;
        }

        .auction-card:hover .card-detailed {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .item-name {
            font-size: 1.4em;
            font-weight: bold;
            color: #2d3e1f;
            margin-bottom: 15px;
        }

        .current-bid {
            font-size: 1.8em;
            color: #4a7c3e;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .time-left {
            color: #d97706;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .bid-count {
            color: #666;
            font-size: 0.95em;
        }

        .item-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .info-row {
            margin-bottom: 10px;
            display: flex;
            gap: 8px;
        }

        .info-label {
            font-weight: 600;
            color: #4a7c3e;
        }

        .description {
            color: #555;
            line-height: 1.6;
            margin-bottom: 12px;
            font-size: 0.95em;
        }

        .card-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1em;
            transition: all 0.3s;
        }

        .btn-bid {
            background: #4a7c3e;
            color: white;
        }

        .btn-bid:hover {
            background: #3a6330;
        }

        .btn-details {
            background: white;
            color: #4a7c3e;
            border: 2px solid #4a7c3e;
        }

        .btn-details:hover {
            background: #f0f4ed;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .modal h2 {
            color: #4a7c3e;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #2d3e1f;
            font-weight: 600;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e8d8;
            border-radius: 8px;
            font-size: 1em;
        }

        .form-group input:focus {
            outline: none;
            border-color: #4a7c3e;
        }

        .close-modal {
            float: right;
            font-size: 28px;
            font-weight: bold;
            color: #999;
            cursor: pointer;
        }

        .close-modal:hover {
            color: #4a7c3e;
        }

        .urgent {
            background: #fef3c7;
            border-color: #f59e0b !important;
        }

        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #666;
            font-size: 1.2em;
        }

        /* Detail Page Styles */
        .detail-page {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .back-btn {
            background: #e0e8d8;
            color: #4a7c3e;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin-bottom: 30px;
            transition: all 0.3s;
        }

        .back-btn:hover {
            background: #d0d8c8;
        }

        .detail-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }

        .detail-image-section img {
            width: 100%;
            height: 400px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .detail-info-section {
            display: flex;
            flex-direction: column;
        }

        .status-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            margin-bottom: 20px;
            width: fit-content;
        }

        .status-active {
            background: #d1fae5;
            color: #065f46;
        }

        .status-ending {
            background: #fef3c7;
            color: #92400e;
        }

        .detail-title {
            font-size: 2.2em;
            color: #2d3e1f;
            margin-bottom: 20px;
        }

        .detail-price-box {
            background: #f0f4ed;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .detail-current-bid {
            font-size: 2.5em;
            color: #4a7c3e;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .seller-card {
            background: #f9faf8;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            border: 2px solid #e0e8d8;
        }

        .seller-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .seller-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #4a7c3e;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: bold;
        }

        .seller-info h3 {
            color: #2d3e1f;
            margin-bottom: 5px;
        }

        .rating {
            color: #f59e0b;
            font-size: 1.1em;
        }

        .detail-info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .detail-info-item {
            background: #f9faf8;
            padding: 15px;
            border-radius: 8px;
        }

        .detail-info-item .label {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .detail-info-item .value {
            color: #2d3e1f;
            font-weight: 600;
            font-size: 1.1em;
        }

        .bid-section {
            background: #f0f4ed;
            padding: 25px;
            border-radius: 12px;
            margin-top: 20px;
        }

        .bid-input-group {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }

        .bid-input-group input {
            flex: 1;
            padding: 15px;
            border: 2px solid #4a7c3e;
            border-radius: 8px;
            font-size: 1.1em;
        }

        .bid-input-group button {
            padding: 15px 30px;
            background: #4a7c3e;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .bid-input-group button:hover {
            background: #3a6330;
        }

        .bid-range-info {
            font-size: 0.9em;
            color: #666;
            margin-top: 10px;
        }

        .detail-description {
            margin: 30px 0;
        }

        .detail-description h3 {
            color: #4a7c3e;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .detail-description p {
            color: #555;
            line-height: 1.8;
            font-size: 1.05em;
        }

        .comments-section {
            margin-top: 40px;
        }

        .comments-section h3 {
            color: #4a7c3e;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .comment {
            background: #f9faf8;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            border-left: 4px solid #4a7c3e;
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .comment-author {
            font-weight: bold;
            color: #2d3e1f;
        }

        .comment-date {
            color: #999;
            font-size: 0.9em;
        }

        .comment-text {
            color: #555;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .detail-container {
                grid-template-columns: 1fr;
            }
            
            .detail-info-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    
    <button class="login-btn" onclick="openLoginModal()" id="loginButton">Login</button>
    <div class="user-balance" id="userBalance"></div>

    <div class="header">
        <h1>üåæ Farm Auction Market</h1>
        <p>Fresh produce, equipment, and supplies - bid now!</p>
    </div>

    <!-- Main Auction List Page -->
    <div id="mainPage">
        <div class="search-container">
            <input type="text" class="search-bar" placeholder="üîç Search for auction items..." onkeyup="searchItems()">
        </div>

        <div class="auction-grid" id="auctionGrid"></div>
    </div>

    <!-- Detail Page -->
    <div id="detailPage" class="detail-page"></div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeLoginModal()">&times;</span>
            <h2>Login to Bid</h2>
            <div class="form-group">
                <label>Username</label>
                <input type="text" id="username" placeholder="Enter your username">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="password" placeholder="Enter your password">
            </div>
            <button class="btn btn-bid" onclick="login()" style="width: 100%">Login</button>
        </div>
    </div>

    <!-- Quick Bid Modal -->
    <div id="bidModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeBidModal()">&times;</span>
            <h2 id="bidItemName"></h2>
            <div class="form-group">
                <label>Current Bid: <span id="bidCurrentPrice"></span></label>
                <label>Your Bid Amount</label>
                <input type="number" id="bidAmount" placeholder="Enter your bid">
                <div class="bid-range-info" id="quickBidRange"></div>
            </div>
            <button class="btn btn-bid" onclick="placeBid()" style="width: 100%">Place Bid</button>
        </div>
    </div>

    <script>
        let isLoggedIn = false;
        let currentUser = null;
        let currentBidItem = null;
        let userBalance = 0;

        const auctionItems = [
            {
                id: 1,
                name: "Organic Wheat Seeds (50kg)",
                image: "https://images.unsplash.com/photo-1574323347407-f5e1ad6d020b?w=800",
                startingPrice: 150,
                currentBid: 285,
                endTime: new Date(Date.now() + 2 * 3600000 + 45 * 60000),
                bidCount: 12,
                description: "Premium organic wheat seeds, certified non-GMO, high yield variety suitable for various soil types. These seeds have been tested for optimal germination rates (>95%) and come with complete certification. Perfect for farmers looking to transition to organic farming or expand their organic crop production. The seeds are treated naturally and stored in climate-controlled facilities to ensure maximum viability.",
                category: "Seeds",
                location: "Punjab, Pakistan",
                seller: {
                    name: "Green Valley Farms",
                    rating: 4.8,
                    totalSales: 156,
                    memberSince: "2020"
                },
                condition: "New",
                weight: "50kg",
                comments: [
                    { author: "Farmer Ahmed", date: "2 hours ago", text: "Is this suitable for clay soil? I have 10 acres ready." },
                    { author: "Green Valley Farms", date: "1 hour ago", text: "Yes, absolutely! These seeds perform excellently in clay soil. Perfect for 10 acres." },
                    { author: "Fatima K.", date: "30 mins ago", text: "Great seller, bought from them before. Highly recommend!" }
                ]
            },
            {
                id: 2,
                name: "Tractor - John Deere 5055E",
                image: "https://images.unsplash.com/photo-1625245488600-f89da8e3dee4?w=800",
                startingPrice: 15000,
                currentBid: 18500,
                endTime: new Date(Date.now() + 24 * 3600000),
                bidCount: 8,
                description: "Well-maintained tractor, 5 years old, 55HP, 4WD with only 1200 hours of use. Complete service history available. This tractor has been professionally serviced every 6 months and all maintenance records are available. Comes with original equipment and attachments. The engine is in excellent condition, transmission smooth, and all hydraulics working perfectly. Recently had a complete inspection by certified John Deere technician. No accidents or major repairs needed. Ready for immediate use on your farm.",
                category: "Equipment",
                location: "Multan, Pakistan",
                seller: {
                    name: "Ahmed Agricultural Services",
                    rating: 4.9,
                    totalSales: 89,
                    memberSince: "2018"
                },
                condition: "Used - Excellent",
                weight: "2500kg",
                comments: [
                    { author: "Bilal Shah", date: "5 hours ago", text: "Can I inspect the tractor before bidding? I'm interested." },
                    { author: "Ahmed Agricultural Services", date: "4 hours ago", text: "Of course! Please call us to schedule a visit. Contact: 0300-1234567" },
                    { author: "Rashid Farm", date: "3 hours ago", text: "Excellent machine, saw it in person. Worth every penny!" }
                ]
            },
            {
                id: 3,
                name: "Fresh Mangoes (100kg)",
                image: "https://images.unsplash.com/photo-1601493700631-2b16ec4b4716?w=800",
                startingPrice: 80,
                currentBid: 125,
                endTime: new Date(Date.now() + 45 * 60000),
                bidCount: 23,
                description: "Premium Sindhri mangoes, hand-picked at peak ripeness. Perfect for wholesale distribution. These mangoes are harvested from our premium orchards where we use sustainable farming practices. Each mango is carefully selected to ensure the highest quality. The fruit is sweet, aromatic, and has the perfect texture. Ideal for direct market sale, juice production, or export. We can arrange immediate delivery within 24 hours to ensure freshness. All mangoes are properly sorted and packaged.",
                category: "Produce",
                location: "Sindh, Pakistan",
                seller: {
                    name: "Mango Paradise",
                    rating: 4.7,
                    totalSales: 234,
                    memberSince: "2019"
                },
                condition: "Fresh",
                weight: "100kg",
                comments: [
                    { author: "Market Trader Ali", date: "15 mins ago", text: "Can you deliver to Karachi by tomorrow morning?" },
                    { author: "Mango Paradise", date: "10 mins ago", text: "Yes, we can arrange morning delivery. Extra charges apply." },
                    { author: "Zahid Fruits", date: "20 mins ago", text: "Best mangoes in the season! Already bought 200kg last week." }
                ]
            },
            {
                id: 4,
                name: "Irrigation System Kit",
                image: "https://images.unsplash.com/photo-1625246333195-78d9c38ad449?w=800",
                startingPrice: 500,
                currentBid: 650,
                endTime: new Date(Date.now() + 6 * 3600000),
                bidCount: 5,
                description: "Complete drip irrigation system for 2 acres, includes pipes, emitters, filters, and control valve. This comprehensive kit contains everything you need to set up an efficient irrigation system. Includes 2000 meters of main line pipes, 500 drippers, pressure regulator, filter system, and detailed installation guide. The system is designed to save up to 60% water compared to traditional irrigation. All components are UV resistant and built to last for years. Technical support available for installation.",
                category: "Equipment",
                location: "Faisalabad, Pakistan",
                seller: {
                    name: "Agri-Tech Solutions",
                    rating: 4.6,
                    totalSales: 67,
                    memberSince: "2021"
                },
                condition: "New",
                weight: "150kg",
                comments: [
                    { author: "Hassan Grower", date: "1 hour ago", text: "Do you provide installation service?" },
                    { author: "Agri-Tech Solutions", date: "45 mins ago", text: "Yes! Installation service available at additional cost. We can discuss details." }
                ]
            },
            {
                id: 5,
                name: "Organic Fertilizer (500kg)",
                image: "https://images.unsplash.com/photo-1530836369250-ef72a3f5cda8?w=800",
                startingPrice: 200,
                currentBid: 240,
                endTime: new Date(Date.now() + 12 * 3600000),
                bidCount: 7,
                description: "100% organic compost fertilizer, rich in nutrients, ideal for vegetable and fruit cultivation. Our premium compost is made from carefully selected organic materials including cow manure, crop residues, and natural minerals. The composting process takes 6 months to ensure all nutrients are properly broken down and available to plants. NPK ratio optimized for various crops. Contains beneficial microorganisms that improve soil health. Certified organic by local agricultural authorities. Safe for all crops and improves soil structure over time.",
                category: "Supplies",
                location: "Lahore, Pakistan",
                seller: {
                    name: "EcoFarm Products",
                    rating: 4.8,
                    totalSales: 178,
                    memberSince: "2019"
                },
                condition: "New",
                weight: "500kg",
                comments: [
                    { author: "Organic Farmer", date: "2 hours ago", text: "What's the NPK ratio? Looking for vegetable farming." },
                    { author: "EcoFarm Products", date: "1 hour ago", text: "NPK is 3-2-2 with added trace minerals. Perfect for vegetables!" },
                    { author: "Green Thumb", date: "30 mins ago", text: "Used this last season. Amazing results on tomatoes and peppers!" }
                ]
            },
            {
                id: 6,
                name: "Dairy Cattle (Holstein)",
                image: "https://images.unsplash.com/photo-1516467508483-a7212febe31a?w=800",
                startingPrice: 2000,
                currentBid: 2450,
                endTime: new Date(Date.now() + 18 * 3600000),
                bidCount: 9,
                description: "Healthy 3-year-old Holstein dairy cow, excellent milk producer (25L/day), vaccinated and certified. This beautiful Holstein has consistently produced high-quality milk with good fat content. She has a gentle temperament, making her easy to handle and milk. All vaccinations are up to date, and health certificates are available. She has had two successful calvings and is currently in her second lactation period. Well-maintained health records available. The cow has been raised on our farm with proper nutrition and care. Comes with complete veterinary documentation.",
                category: "Livestock",
                location: "Sahiwal, Pakistan",
                seller: {
                    name: "Dairy Excellence Farm",
                    rating: 4.9,
                    totalSales: 45,
                    memberSince: "2017"
                },
                condition: "Excellent Health",
                weight: "650kg",
                comments: [
                    { author: "Dairy Farmer Khan", date: "6 hours ago", text: "Is she currently pregnant? Planning to expand my dairy farm." },
                    { author: "Dairy Excellence Farm", date: "5 hours ago", text: "Not currently pregnant but can be bred. She's in excellent breeding condition." },
                    { author: "Livestock Buyer", date: "4 hours ago", text: "Visited the farm yesterday. Beautiful animal, very healthy!" }
                ]
            }
        ];

        function formatTimeRemaining(endTime) {
            const now = new Date();
            const diff = endTime - now;
            
            if (diff <= 0) return "Ended";
            
            const hours = Math.floor(diff / 3600000);
            const minutes = Math.floor((diff % 3600000) / 60000);
            
            if (hours > 24) {
                const days = Math.floor(hours / 24);
                return `${days}d ${hours % 24}h remaining`;
            }
            return `${hours}h ${minutes}m remaining`;
        }

        function formatLongDate(date) {
            return `Ends: ${date.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            })}`;
        }

        function renderAuctionItems(items) {
            const grid = document.getElementById('auctionGrid');
            
            if (items.length === 0) {
                grid.innerHTML = '<div class="no-results">No items found matching your search.</div>';
                return;
            }

            grid.innerHTML = items.map(item => {
                const timeLeft = item.endTime - new Date();
                const isUrgent = timeLeft < 3600000;
                
                return `
                    <div class="auction-card ${isUrgent ? 'urgent' : ''}">
                        <div class="card-minimal">
                            <div class="item-name">${item.name}</div>
                            <div class="current-bid">$${item.currentBid}</div>
                            <div class="time-left">‚è∞ ${formatTimeRemaining(item.endTime)}</div>
                            <div class="bid-count">üìä ${item.bidCount} bids</div>
                        </div>
                        
                        <div class="card-detailed">
                            <img src="${item.image}" alt="${item.name}" class="item-image">
                            <div class="item-name">${item.name}</div>
                            
                            <div class="info-row">
                                <span class="info-label">Category:</span>
                                <span>${item.category}</span>
                            </div>
                            
                            <div class="description">${item.description.substring(0, 120)}...</div>
                            
                            <div class="info-row">
                                <span class="info-label">Starting Price:</span>
                                <span>$${item.startingPrice}</span>
                            </div>
                            
                            <div class="info-row">
                                <span class="info-label">Current Bid:</span>
                                <span class="current-bid">$${item.currentBid}</span>
                            </div>
                            
                            <div class="info-row">
                                <span class="info-label">Location:</span>
                                <span>${item.location}</span>
                            </div>
                            
                            <div class="info-row">
                                <span class="info-label">Seller:</span>
                                <span>${item.seller.name}</span>
                            </div>
                            
                            <div class="time-left">‚è∞ ${formatLongDate(item.endTime)}</div>
                            <div class="bid-count">üìä ${item.bidCount} bids placed</div>
                            
                            <div class="card-actions">
                                <button class="btn btn-bid" onclick="openBidModal(${item.id})">Place Bid</button>
                                <button class="btn btn-details" onclick="viewDetails(${item.id})">View Details</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function sortItemsByTimeLeft() {
            return [...auctionItems].sort((a, b) => {
                return (a.endTime - new Date()) - (b.endTime - new Date());
            });
        }

        function searchItems() {
            const searchTerm = document.querySelector('.search-bar').value.toLowerCase();
            const filtered = auctionItems.filter(item => 
                item.name.toLowerCase().includes(searchTerm) ||
                item.category.toLowerCase().includes(searchTerm) ||
                item.description.toLowerCase().includes(searchTerm) ||
                item.location.toLowerCase().includes(searchTerm)
            );
            
            const sorted = filtered.sort((a, b) => 
                (a.endTime - new Date()) - (b.endTime - new Date())
            );
            
            renderAuctionItems(sorted);
        }

        function openLoginModal() {
            document.getElementById('loginModal').style.display = 'flex';
        }

        function closeLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
        }

        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username && password) {
                isLoggedIn = true;
                currentUser = username;
                // Simulate random user balance between 5000-25000
                userBalance = Math.floor(Math.random() * 20000) + 5000;
                
                alert('Login successful! You can now place bids.');
                closeLoginModal();
                document.getElementById('loginButton').textContent = `üëã ${username}`;
                document.getElementById('userBalance').textContent = `üí∞ Balance: ${userBalance}`;
                document.getElementById('userBalance').style.display = 'block';
            } else {
                alert('Please enter both username and password.');
            }
        }

        function openBidModal(itemId) {
            if (!isLoggedIn) {
                alert('Please login to place a bid.');
                openLoginModal();
                return;
            }
            
            currentBidItem = auctionItems.find(item => item.id === itemId);
            document.getElementById('bidItemName').textContent = currentBidItem.name;
            document.getElementById('bidCurrentPrice').textContent = `${currentBidItem.currentBid}`;
            document.getElementById('quickBidRange').textContent = `You can bid between ${currentBidItem.currentBid + 1} and ${userBalance}`;
            document.getElementById('bidAmount').value = '';
            document.getElementById('bidAmount').min = currentBidItem.currentBid + 1;
            document.getElementById('bidAmount').max = userBalance;
            document.getElementById('bidModal').style.display = 'flex';
        }

        function closeBidModal() {
            document.getElementById('bidModal').style.display = 'none';
            currentBidItem = null;
        }

        function placeBid() {
            const bidAmount = parseFloat(document.getElementById('bidAmount').value);
            
            if (!bidAmount || bidAmount <= currentBidItem.currentBid) {
                alert(`Your bid must be higher than the current bid of ${currentBidItem.currentBid}`);
                return;
            }
            
            if (bidAmount > userBalance) {
                alert(`Your bid cannot exceed your available balance of ${userBalance}`);
                return;
            }
            
            currentBidItem.currentBid = bidAmount;
            currentBidItem.bidCount++;
            
            alert(`Bid placed successfully! Your bid of ${bidAmount} is now the highest bid.`);
            closeBidModal();
            renderAuctionItems(sortItemsByTimeLeft());
            
            // If on detail page, refresh it
            if (document.getElementById('detailPage').style.display === 'block') {
                viewDetails(currentBidItem.id);
            }
        }

        function viewDetails(itemId) {
            const item = auctionItems.find(i => i.id === itemId);
            const timeLeft = item.endTime - new Date();
            const isUrgent = timeLeft < 3600000;
            const statusClass = isUrgent ? 'status-ending' : 'status-active';
            const statusText = isUrgent ? '‚ö†Ô∏è Ending Soon' : '‚úÖ Active Auction';
            
            const detailHTML = `
                <button class="back-btn" onclick="goBackToList()">‚Üê Back to Auctions</button>
                
                <div class="detail-container">
                    <div class="detail-image-section">
                        <img src="${item.image}" alt="${item.name}">
                    </div>
                    
                    <div class="detail-info-section">
                        <div class="status-badge ${statusClass}">${statusText}</div>
                        <h1 class="detail-title">${item.name}</h1>
                        
                        <div class="detail-price-box">
                            <div style="color: #666; margin-bottom: 5px;">Current Bid</div>
                            <div class="detail-current-bid">${item.currentBid}</div>
                            <div style="color: #666; font-size: 0.95em;">Starting Price: ${item.startingPrice}</div>
                            <div style="color: #d97706; font-weight: 600; margin-top: 10px;">‚è∞ ${formatTimeRemaining(item.endTime)}</div>
                            <div style="color: #666; font-size: 0.9em; margin-top: 5px;">${formatLongDate(item.endTime)}</div>
                            <div style="color: #666; margin-top: 10px;">üìä ${item.bidCount} bids placed</div>
                        </div>
                        
                        <div class="seller-card">
                            <div class="seller-header">
                                <div class="seller-avatar">${item.seller.name.charAt(0)}</div>
                                <div class="seller-info">
                                    <h3>${item.seller.name}</h3>
                                    <div class="rating">‚≠ê ${item.seller.rating}/5.0 (${item.seller.totalSales} sales)</div>
                                    <div style="color: #666; font-size: 0.9em;">Member since ${item.seller.memberSince}</div>
                                </div>
                            </div>
                        </div>
                        
                        ${isLoggedIn ? `
                        <div class="bid-section">
                            <h3 style="color: #2d3e1f; margin-bottom: 10px;">Place Your Bid</h3>
                            <div class="bid-range-info">You can bid between ${item.currentBid + 1} and ${userBalance}</div>
                            <div class="bid-input-group">
                                <input type="number" id="detailBidInput" placeholder="Enter your bid" min="${item.currentBid + 1}" max="${userBalance}">
                                <button onclick="placeBidFromDetail(${item.id})">Place Bid</button>
                            </div>
                        </div>
                        ` : `
                        <div class="bid-section">
                            <h3 style="color: #2d3e1f; margin-bottom: 10px;">Want to Place a Bid?</h3>
                            <p style="margin-bottom: 15px;">Please login to participate in this auction.</p>
                            <button class="btn btn-bid" onclick="openLoginModal()" style="width: 100%;">Login to Bid</button>
                        </div>
                        `}
                    </div>
                </div>
                
                <div class="detail-info-grid">
                    <div class="detail-info-item">
                        <div class="label">Category</div>
                        <div class="value">${item.category}</div>
                    </div>
                    <div class="detail-info-item">
                        <div class="label">Condition</div>
                        <div class="value">${item.condition}</div>
                    </div>
                    <div class="detail-info-item">
                        <div class="label">Location</div>
                        <div class="value">${item.location}</div>
                    </div>
                    <div class="detail-info-item">
                        <div class="label">Weight/Quantity</div>
                        <div class="value">${item.weight}</div>
                    </div>
                </div>
                
                <div class="detail-description">
                    <h3>Description</h3>
                    <p>${item.description}</p>
                </div>
                
                <div class="comments-section">
                    <h3>Comments & Questions (${item.comments.length})</h3>
                    ${item.comments.map(comment => `
                        <div class="comment">
                            <div class="comment-header">
                                <span class="comment-author">üë§ ${comment.author}</span>
                                <span class="comment-date">${comment.date}</span>
                            </div>
                            <div class="comment-text">${comment.text}</div>
                        </div>
                    `).join('')}
                    
                    ${isLoggedIn ? `
                    <div style="margin-top: 20px;">
                        <textarea placeholder="Ask a question about this item..." style="width: 100%; padding: 15px; border: 2px solid #e0e8d8; border-radius: 8px; font-family: inherit; font-size: 1em; min-height: 80px;"></textarea>
                        <button class="btn btn-bid" style="margin-top: 10px;" onclick="alert('Comment feature coming soon!')">Post Comment</button>
                    </div>
                    ` : ''}
                </div>
            `;
            
            document.getElementById('detailPage').innerHTML = detailHTML;
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('detailPage').style.display = 'block';
            window.scrollTo(0, 0);
        }

        function goBackToList() {
            document.getElementById('mainPage').style.display = 'block';
            document.getElementById('detailPage').style.display = 'none';
            renderAuctionItems(sortItemsByTimeLeft());
        }

        function placeBidFromDetail(itemId) {
            const item = auctionItems.find(i => i.id === itemId);
            const bidAmount = parseFloat(document.getElementById('detailBidInput').value);
            
            if (!bidAmount || bidAmount <= item.currentBid) {
                alert(`Your bid must be higher than the current bid of ${item.currentBid}`);
                return;
            }
            
            if (bidAmount > userBalance) {
                alert(`Your bid cannot exceed your available balance of ${userBalance}`);
                return;
            }
            
            item.currentBid = bidAmount;
            item.bidCount++;
            
            alert(`Bid placed successfully! Your bid of ${bidAmount} is now the highest bid.`);
            viewDetails(itemId);
        }

        // Initialize
        renderAuctionItems(sortItemsByTimeLeft());

        // Update countdowns every minute
        setInterval(() => {
            if (document.getElementById('mainPage').style.display !== 'none') {
                renderAuctionItems(sortItemsByTimeLeft());
            }
        }, 60000);
    </script>
</body>
</html>